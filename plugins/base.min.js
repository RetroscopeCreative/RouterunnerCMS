routerunner_base=function(m){var q=m?m:window,e={},f={},k=[],l=!1,n=!1,p=[],g=[];this.container={};this.states={home:0,browse:1,edit:2,newsletter:3,panel_destroy:7,enabled:8,disabled:9,loaded:100,refresh:101,resize:102,destroy:199,modelselect:200,updatechanges:201,revert:800,force_blur:899,apply:900};this.statenames={};this.init=function(){var a=this;$.each(this.states,function(c,b){a.statenames[b]=c})};this.parent=function(){return q};this.rootrunner=function(){return"undefined"!=typeof routerunner?
    routerunner:this};this.instance=function(a,c,b){void 0==a&&(a=!1);if(c||null===c)b?(!1===a&&f[b]?a=this.object_len(f[b]):!1===a&&(a=0),f[b]||(f[b]={}),-1===$.inArray(b,k)&&k.push(b),null===c?delete f[b][a]:(f[b][a]=c,"function"==typeof f[b][a].state&&f[b][a].state(this.rootrunner().state()))):(!1===a&&(a=this.object_len(e)),null===c?delete e[a]:(e[a]=c,"function"==typeof e[a].state&&e[a].state(this.rootrunner().state())));return!1!==a?b?f[b]&&f[b][a]?f[b][a]:!1:e[a]?e[a]:!1:b?f[b]?f[b]:!1:e};this.last_instance=
    function(a){var c=!1,b=Object.keys(this.instance());a&&-1<$.inArray(a,b)&&(b=b.slice(0,$.inArray(a,b)));b.length&&(last_instance_key=b.pop())&&(c=this.instance(last_instance_key));return c};this.state=function(a,c,b,d){var f=this;if(a){var h=!1,e=!1;isNaN(parseInt(a))?(e=a,h=this.rootrunner().states[a]):(h=a,e=this.rootrunner().statenames[h]);l&&(n=this.rootrunner().statenames[l]);l=h;a={};if(!c&&"function"==typeof this[e])if(b)this[e](b);else this[e]();!d&&(a=this.instance())&&$.each(a,function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         b){"function"==typeof b.state&&b.state(h,c)});k.length&&$.each(k,function(a,b){var e={};d&&d!==b||!(e=f.instance(!1,!1,b))||$.each(e,function(a,b){"function"==typeof b.state&&b.state(h,c)})})}return this.rootrunner().statenames[l]};this.laststate=function(){return n};this.action=function(a,c,b){if(a){var d=this.state(!1,!1,!1,b);this.state(a,!1,c,b);this.state(d,!0,!1,b);p.push(a)}return p};this.queue=function(a,c){a&&(c&&!this.get(c)&&this.set(c,[]),(c?this.get(c):g).push(a));return c?this.get(c):
    g};this.unqueue=function(a,c){var b=$.inArray(a,c?this.get(c):g);(c?this.get(c):g).splice(b,1);return c?this.get(c):g};this.ready=function(a){return!(a?this.get(a):g).length};this.construct=function(){return this};this.self=function(){return this};this.wait_for_ready=function(a,c,b){var d=this;b=b?b+1:0;clearTimeout(this.rootrunner().get("delay/timers/"+c));if(this.ready(c))a();else if(b<=this.rootrunner().get("delay/timeout"))this.rootrunner().set("delay/timers/"+c,setTimeout(function(){d.wait_for_ready(a,
    c,b)},this.rootrunner().get("delay/interval")));else throw Error("Timeout!");};this._get=function(a,c,b){var d=void 0==b||void 0==this[b]?this.container:this.container[b];"string"==typeof a&&(a=a.split("/"));void 0==c&&(c=!0);$.each(a,function(a,b){if(void 0!=d[b])d=d[b];else if(c)return d=!1});return d};this._set=function(a,c,b){var d=this.container;void 0!=b&&void 0!=d[b]&&(d=d[b]);a=a.split("/");for(b=!1;b=a.shift();)"object"!=typeof d[b]&&(d[b]=a.length?{}:c),d=d[b];return c};this.get=function(a){return this._get(a)};
    this.set=function(a,c){return this._set(a,c)};this.config=function(a,c){if(void 0!=c){var b=this._set(a,c,"config");return this[a]=b}return this._get(a,!1,"config")};this.remove_change=function(a){this.instance(a,null);var c=this.rootrunner().get("changes");c||(c=[]);var b=!1;-1<(b=$.inArray(a,c))&&c.splice(b,1);this.rootrunner().set("changes",c);(c=this.rootrunner().get("changes_by_model"))||(c={});c[a]&&delete c[a];this.rootrunner().set("changes_by_model",c);this.states&&this.states.undo&&-1<(b=
        $.inArray(a,this.states.undo))&&this.states.undo.splice(b,1)};this.load_script=function(a,c,b){b||".css"==a.substr(-4)&&".php"!=a.substr(-4)&&"/"!=a.substr(0,1)&&"http"!=a.substr(0,4)?(".js"==a.substr(-3)?(b=document.createElement("script"),b.setAttribute("type","text/javascript"),b.setAttribute("src",a)):(".css"==a.substr(-4)?(b=document.createElement("link"),b.setAttribute("rel","stylesheet"),b.setAttribute("type","text/css")):(b=document.createElement("link"),b.setAttribute("data-type","unknown")),
        b.setAttribute("href",a)),document.getElementsByTagName("head")[0].appendChild(b),$(b).load(function(){"function"==typeof c&&c()})):(b={},$.extend(b,{url:a,dataType:!1,async:!1}),b.dataType||".php"!=a.substr(-4)&&".htm"!=a.substr(-4)&&".html"!=a.substr(-5)?b.dataType||".json"!=a.substr(-5)?b.dataType||".xml"!=a.substr(-4)?b.dataType||(b.dataType="script"):b.dataType="xml":b.dataType="json":b.dataType="html",$.ajax(b).done(function(b){"function"==typeof c&&c(b)}).fail(function(b,a,c){console.log(b,
        a,c);throw Error("Script loader error!");}))};this.parseFn=function(a){a=a.split(".");var c=window;$.each(a,function(b,a){c=c&&"undefined"!=typeof c[a]?c[a]:!1});return c};this.init();return this};