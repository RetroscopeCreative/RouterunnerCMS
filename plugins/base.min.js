routerunner_base=function(t){var e=t||window,n={},s={},i=[],r=!1,o=!1,a=[],u=[];return this.container={},this.states={home:0,browse:1,edit:2,newsletter:3,panel_destroy:7,enabled:8,disabled:9,loaded:100,refresh:101,resize:102,destroy:199,modelselect:200,updatechanges:201,revert:800,force_blur:899,apply:900},this.statenames={},this.init=function(){var t=this;$.each(this.states,function(e,n){t.statenames[n]=e})},this.parent=function(){return e},this.rootrunner=function(){return"undefined"!=typeof routerunner?routerunner:"undefined"!=typeof routerunner_form&&this instanceof routerunner_form?this:(void 0!==this.form&&routerunner_input,this)},this.instance=function(t,e,r){return void 0==t&&(t=!1),(e||null===e)&&(r?(!1===t&&s[r]?t=this.object_len(s[r]):!1===t&&(t=0),s[r]||(s[r]={}),-1===$.inArray(r,i)&&i.push(r),null===e?delete s[r][t]:(s[r][t]=e,"function"==typeof s[r][t].state&&s[r][t].state(this.rootrunner().state()))):(!1===t&&(t=this.object_len(n)),null===e?delete n[t]:(n[t]=e,"function"==typeof n[t].state&&n[t].state(this.rootrunner().state())))),!1!==t?r?!(!s[r]||!s[r][t])&&s[r][t]:!!n[t]&&n[t]:r?!!s[r]&&s[r]:n},this.last_instance=function(t){var e=!1,n=Object.keys(this.instance());return t&&$.inArray(t,n)>-1&&(n=n.slice(0,$.inArray(t,n))),n.length&&(last_instance_key=n.pop())&&(e=this.instance(last_instance_key)),e},this.state=function(t,e,n,s){var a=this;if(t){var u=!1,h=!1;isNaN(parseInt(t))?(h=t,u=this.rootrunner().states[t]):(u=t,h=this.rootrunner().statenames[u]),r&&(o=this.rootrunner().statenames[r]),r=u;var c={};e||"function"!=typeof this[h]||(n?this[h](n):this[h]()),!s&&(c=this.instance())&&$.each(c,function(t,n){"function"==typeof n.state&&n.state(u,e)}),i.length&&$.each(i,function(t,n){var i={};s&&s!==n||!(i=a.instance(!1,!1,n))||$.each(i,function(t,n){"function"==typeof n.state&&n.state(u,e)})})}return this.rootrunner().statenames[r]},this.laststate=function(){return o},this.action=function(t,e,n){if(t){var s=this.state(!1,!1,!1,n);this.state(t,!1,e,n),this.state(s,!0,!1,n),a.push(t)}return a},this.queue=function(t,e){return t&&(e&&!this.get(e)&&this.set(e,[]),(e?this.get(e):u).push(t)),e?this.get(e):u},this.unqueue=function(t,e){var n=$.inArray(t,e?this.get(e):u);return(e?this.get(e):u).splice(n,1),e?this.get(e):u},this.ready=function(t){return!(t?this.get(t):u).length},this.construct=function(){return this},this.self=function(){return this},this.wait_for_ready=function(t,e,n){var s=this;if(n=n?n+1:0,clearTimeout(this.rootrunner().get("delay/timers/"+e)),this.ready(e))t();else{if(!(n<=this.rootrunner().get("delay/timeout")))throw Error("Timeout!");this.rootrunner().set("delay/timers/"+e,setTimeout(function(){s.wait_for_ready(t,e,n)},this.rootrunner().get("delay/interval")))}},this._get=function(t,e,n){var s=this,i=void 0==n||void 0==s[n]?this.container:this.container[n];return"string"==typeof t&&(t=t.split("/")),void 0==e&&(e=!0),$.each(t,function(t,n){if(void 0!=i[n])i=i[n];else if(e)return i=!1}),i},this._set=function(t,e,n){var s=this.container;void 0!=n&&void 0!=s[n]&&(s=s[n]),t=t.split("/");for(var i=!1;i=t.shift();)"object"!=typeof s[i]&&(s[i]=t.length?{}:e),s=s[i];return e},this.get=function(t){return this._get(t)},this.set=function(t,e){return this._set(t,e)},this.config=function(t,e){if(void 0!=e){var n=this._set(t,e,"config");return this[t]=n,n}return this._get(t,!1,"config")},this.remove_change=function(t){this.instance(t,null);var e=this.rootrunner().get("changes");e||(e=[]);var n=!1;(n=$.inArray(t,e))>-1&&e.splice(n,1),this.rootrunner().set("changes",e);var s=this.rootrunner().get("changes_by_model");s||(s={}),s[t]&&delete s[t],this.rootrunner().set("changes_by_model",s),this.states&&this.states.undo&&(n=$.inArray(t,this.states.undo))>-1&&this.states.undo.splice(n,1)},this.load_script=function(t,e,n){if(n||".css"==t.substr(-4)&&".php"!=t.substr(-4)&&"/"!=t.substr(0,1)&&"http"!=t.substr(0,4)){if(".js"==t.substr(-3))(s=document.createElement("script")).setAttribute("type","text/javascript"),s.setAttribute("src",t),document.getElementsByTagName("head")[0].appendChild(s);else if(".css"==t.substr(-4))(s=document.createElement("link")).setAttribute("rel","stylesheet"),s.setAttribute("type","text/css"),s.setAttribute("href",t),document.getElementsByTagName("head")[0].appendChild(s);else{var s=document.createElement("link");s.setAttribute("data-type","unknown"),s.setAttribute("href",t),document.getElementsByTagName("head")[0].appendChild(s)}$(s).on("load",function(){"function"==typeof e&&e()})}else{var i={};$.extend(i,{url:t,dataType:!1,async:!1}),i.dataType||".php"!=t.substr(-4)&&".htm"!=t.substr(-4)&&".html"!=t.substr(-5)?i.dataType||".json"!=t.substr(-5)?i.dataType||".xml"!=t.substr(-4)?i.dataType||(i.dataType="script"):i.dataType="xml":i.dataType="json":i.dataType="html",$.ajax(i).done(function(t){"function"==typeof e&&e(t)}).fail(function(t,e,n){throw console.log(t,e,n),Error("Script loader error!")})}},this.parseFn=function(t){var e=t.split("."),n=window;return $.each(e,function(t,e){n=!(!n||void 0===n[e])&&n[e]}),n},this.init(),this};